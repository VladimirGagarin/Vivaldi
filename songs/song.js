document.addEventListener("DOMContentLoaded",(function(){let e=!1,n=!1,t=null,o=0,r=[],l=[],i=[],s=[];const a=[],c=JSON.parse(localStorage.getItem("LikedSongs")||"[]"),d=JSON.parse(localStorage.getItem("ListenedSongs")||"[]"),u=JSON.parse(localStorage.getItem("UserPlaylist")||"[]");let m=null;document.documentElement.scrollTop=0;const g=document.querySelectorAll(".header-spot button")[1],y=document.querySelectorAll(".header-spot button")[0];document.querySelector(".header-spot h2");g.disabled=!0,document.addEventListener("contextmenu",(function(e){e.preventDefault()})),document.addEventListener("keydown",(function(e){("F12"===e.key||e.ctrlKey&&e.shiftKey&&"I"===e.key||e.ctrlKey&&e.shiftKey&&"C"===e.key||e.ctrlKey&&e.shiftKey&&"J"===e.key)&&(e.preventDefault(),T("Not now for the moment."))}));const f=[{albumName:"RnB",albumImage:"./images/rnb.jpg",description:"Smooth, soulful tunes to set the mood right."},{albumName:"Airwave Music",albumImage:"./images/airwave.jpg",description:"Feel the breeze of uplifting beats and serene melodies."},{albumName:"Chills",albumImage:"./images/chills.jpg",description:"Relax and unwind with soothing and calming sounds."},{albumName:"Twilight",albumImage:"./images/twilight.jpg",description:"Melodies as magical as the twilight hour."},{albumName:"Two Steps From Hell",albumImage:"/images/hell.jpg",description:"Epic and inspiring orchestral masterpieces."},{albumName:"Classical",albumImage:"/images/waltz.jpg",description:"Graceful rhythms for dreamy dances under the stars."},{albumName:"Disney",albumImage:"/images/disney.jpg",description:"Magical tunes that spark joy and nostalgia."},{albumName:"Ncs",albumImage:"/images/ncs.jpg",description:"Non-stop energy with no copyright beats."},{albumName:"Celine Dion",albumImage:"/images/celine.jpg",description:"Iconic ballads and heartfelt anthems from the queen of vocals."},{albumName:"Bongo",albumImage:"/images/bongo.jpg",description:"Vibrant African rhythms to get you moving."},{albumName:"Bollywood",albumImage:"/images/bollywood.jpg",description:"Bollywood beats that bring drama and romance to life."},{albumName:"Others",albumImage:"/images/others.jpg",description:"A mix of unique sounds for every curious ear."},{albumName:"Cool",albumImage:"/images/cool.jpg",description:"Refreshing vibes to keep you chill."}],p=[{mood:"Upbeat",description:"Energetic and lively songs, often with a fast tempo and positive energy.",reader:"cantabile/reader1.mp3"},{mood:"Happy",description:"Cheerful and light-hearted songs, designed to boost your spirits.",reader:"cantabile/reader2.mp3"},{mood:"Sad",description:"Songs that evoke sadness or melancholy feelings.",reader:"cantabile/reader3.mp3"},{mood:"Romantic",description:"Songs that convey love, affection, and romantic emotions.",reader:"cantabile/reader4.mp3"},{mood:"Motivational",description:"Songs that inspire and encourage action, often used for workouts or personal growth.",reader:"cantabile/reader5.mp3"},{mood:"Relaxing",description:"Calm, soothing songs that help with relaxation or stress relief.",reader:"cantabile/reader6.mp3"},{mood:"Angry",description:"Songs that express frustration, rage, or strong emotions.",reader:"cantabile/reader7.mp3"},{mood:"Mellow",description:"Smooth and gentle songs that create a laid-back atmosphere.",reader:"cantabile/reader8.mp3"},{mood:"Dreamy",description:"Songs with a soft, ethereal, or otherworldly vibe.",reader:"cantabile/reader9.mp3"},{mood:"Nostalgic",description:"Songs that evoke memories of the past, often bittersweet.",reader:"cantabile/reader10.mp3"},{mood:"Epic",description:"Grand, powerful songs often used in movie soundtracks or anthems.",reader:"cantabile/reader11.mp3"},{mood:"Chill",description:"Laid-back, easy-going songs, often associated with relaxing moments.",reader:"cantabile/reader12.mp3"},{mood:"Party",description:"High-energy songs for social gatherings, clubs, or celebrations.",reader:"cantabile/reader13.mp3"},{mood:"Melancholic",description:"Songs that reflect deep sadness or a reflective, sorrowful mood.",reader:"cantabile/reader14.mp3"},{mood:"Hopeful",description:"Songs that convey optimism, anticipation, or positive aspirations.",reader:"cantabile/reader15.mp3"},{mood:"Sentimental",description:"Songs that evoke deep emotions and affection, often tied to memories.",reader:"cantabile/reader16.mp3"},{mood:"Peaceful",description:"Calm and serene songs, perfect for unwinding and inner peace.",reader:"cantabile/reader17.mp3"},{mood:"Intense",description:"Songs that are dramatic and full of energy, creating a sense of urgency.",reader:"cantabile/reader18.mp3"},{mood:"Fun",description:"Light-hearted and playful songs, often associated with good times and laughter.",reader:"cantabile/reader19.mp3"},{mood:"Euphoric",description:"Songs that evoke intense joy or bliss, often with a dance or trance feel.",reader:"cantabile/reader20.mp3"}];function h(e,n,t=(()=>{}),...o){if(!(e&&e instanceof HTMLElement))return void console.error("Invalid container provided.");const r=document.createDocumentFragment(),l=document.createElement("li");l.innerHTML=`<span>${n}</span>`,l.onclick=()=>t(...o),r.appendChild(l),e.appendChild(r)}function S(e){const n=document.querySelector(".detail-section .left-detail h2"),t=document.querySelector(".detail-section .left-detail p");t.textContent="",n.textContent="",n.textContent=e.songName,t.textContent=`${e.songArtist1} ${e.songArtist2?`Featuring ${e.songArtist2}`:""}`}function b(e){if(0===s.length)return console.warn("All songs array is empty."),void(document.querySelector(".minor-songs").style.display="none");const n=document.querySelector("main #Feed .minor-songs ul"),t=f.find((n=>n.albumName===e.songGenre));if(!n)return void console.error("Minor songs container not found.");const r=document.createElement("li");r.innerHTML=`\n            <div class="song-title">\n                <h3>${e.songName}</h3>\n            </div>\n            <div class="song-album-name">\n                <h3>${e.songGenre}</h3>\n            </div>\n        `,t?r.style.backgroundImage=`url('${t.albumImage}')`:(console.warn(`No album found for genre: ${e.songGenre}`),r.style.backgroundImage="url('logo.jpg')"),n.appendChild(r),r.onclick=function(){v(e,!1),o=Array.from(document.querySelectorAll(".playing-section .right-section ul li")).findIndex((n=>n.textContent.includes(e.songKeyWord)))}}function v(e,n){if(localStorage.setItem("currentSong",JSON.stringify(e)),N(e,n),document.title=`${e.songKeyWord} - (Playing)`,n){const t=e.songMood.find((e=>e===m));x(e,t,n)}else x(e,e.songGenre,n);o=Array.from(document.querySelectorAll(".playing-section .right-section ul li")).findIndex((n=>n.textContent.includes(e.songKeyWord)))}function q(e){const n=e;for(let e=n.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[n[e],n[t]]=[n[t],n[e]]}return n}function A(e){const n=[document.querySelector("main #Feed"),document.querySelector("main #spotlight"),document.querySelector("main #SearchField")];n.forEach((e=>{e.style.display="none"})),n[e]?(console.log(n[e]),n[e].style.display="flex"):console.error(`Section at index ${e} does not exist.`)}function N(n,r){const l=localStorage.getItem("currentSong");let i=!1,s=!1;l&&JSON.parse(l).songName===n.songName||localStorage.setItem("currentSong",JSON.stringify(n)),A(1),S(n);let a=!1;t&&!t.paused&&t.pause(),t=new Audio(`../${n.songUrl}`);const u=document.querySelectorAll(".playing-section .left-section .currentSong-preview .current-song-controls .controls .left-controls button")[1],m=document.querySelectorAll(".playing-section .left-section .currentSong-preview .current-song-controls .controls .left-controls button")[0],g=document.querySelectorAll(".playing-section .left-section .currentSong-preview .current-song-controls .controls .left-controls button")[2],y=document.querySelectorAll(".playing-section .left-section .currentSong-preview .current-song-controls .controls .left-controls button")[3],p=document.querySelectorAll(".playing-section .left-section .currentSong-preview .current-song-controls .controls .left-controls button")[4],h=document.querySelector(".playing-section .left-section .currentSong-preview .current-song-controls .controls .left-controls .vol-slider input"),b=document.querySelector(".playing-section .left-section .currentSong-preview .current-song-controls .progress-truck .progress-bar"),v=document.querySelector(".playing-section .left-section .currentSong-preview .current-song-controls .controls .right-controls span"),q=document.querySelectorAll(".playing-section .left-section .currentSong-preview .current-song-controls .controls .right-controls button")[0],N=document.querySelectorAll(".playing-section .left-section .currentSong-preview .current-song-controls .controls .right-controls button")[1],x=b.parentElement;let C,k=10;document.querySelector(".playing-section .overlay-song-info").style.display="none",e=!1,t.play().then((()=>{t.muted=i,p.innerHTML='<i class="fa-solid fa-volume-high"></i>',t.loop=s,q.innerHTML='<i class="fa-solid fa-repeat"></i>',a=!0,u.innerHTML=a?"&#10074;&#10074;":"&#9654;",document.title=`${n.songKeyWord} - (Playing)`})).catch((e=>{"NotAllowedError"===e.name&&(document.getElementById("playback-overlay").style.display="flex",document.getElementById("playback-btn").addEventListener("click",(()=>{document.getElementById("playback-overlay").style.display="none",t.play().catch((e=>console.error("Still failed:",e)))}),{once:!0}))})),t.volume=h.value/100,h.oninput=function(){const e=h.value/100;t.volume=e,t.muted=0===e,p.innerHTML=0===e?'<i class="fa-solid fa-volume-xmark"></i>':e>0&&e<=.4?'<i class="fa-solid fa-volume-low"></i>':'<i class="fa-solid fa-volume-high"></i>'},p.onclick=function(){i=!i,t.muted=i,i?(p.innerHTML="&#128264;",h.value=0):(p.innerHTML="&#128263;",h.value=100*t.volume)},q.onclick=function(){s=!s,t.loop=s,q.innerHTML=s?"ðŸ”‚":'<i class="fa-solid fa-repeat"></i>'},t.addEventListener("timeupdate",(function(){const e=t.currentTime/t.duration*100;b.style.width=`${e}%`,v.textContent=`${L(t.currentTime)} / ${t.duration?L(t.duration):"00 : 00"}`})),t.addEventListener("pause",(function(){document.title="Songs | Vivaldi Cantabile"})),t.addEventListener("canplay",(function(){const e=f.find((e=>e.albumName===n.songGenre));T(`${n.songArtist1} - ${n.songKeyWord} - (Playing)`,e.albumImage),clearInterval(C)})),t.addEventListener("playing",(function(){document.title=`${n.songArtist1} - ${n.songKeyWord} - (Playing)`,v.textContent="",clearInterval(C),a=!0,u.innerHTML=a?"&#10074;&#10074;":"&#9654;"})),t.addEventListener("ended",(function(){a=!1,b.style.width="0%",document.title="Songs | Vivaldi Cantabile",u.innerHTML=a?"&#10074;&#10074;":"&#9654;",s||$("forward",r);d.some((e=>e.songName===n.songName))||(d.length>30&&d.shift(),d.push(n),localStorage.setItem("ListenedSongs",JSON.stringify(d)))})),t.addEventListener("error",(function(){u.disabled=!0,g.disabled=!0,m.disabled=!0,v.textContent="page reload in 10 sec",setTimeout((function(){C=setInterval((function(){k--,v.textContent=`Page reloads in ${k} sec`,k>=0&&(clearInterval(C),window.location.reload())}),1e3)}),5e3),a=!1,u.innerHTML=a?"&#10074;&#10074;":"&#9654;"})),t.addEventListener("waiting",(function(){u.disabled=!0,g.disabled=!0,m.disabled=!0,a=!1,u.innerHTML=a?"&#10074;&#10074;":"&#9654;"})),t.addEventListener("Stalled",(function(){u.disabled=!0,g.disabled=!0,m.disabled=!0,a=!1,u.innerHTML=a?"&#10074;&#10074;":"&#9654;"})),t.addEventListener("canplay",(function(){u.disabled=!1,g.disabled=!1,m.disabled=!1,v.textContent="",clearInterval(C)})),t.addEventListener("loadedmetadata",(function(){u.disabled=!1,g.disabled=!1,m.disabled=!1,v.textContent="",clearInterval(C)})),u.onclick=function(){a=!a,u.innerHTML=a?"&#10074;&#10074;":"&#9654;",a?t.play():t.pause(),o=Array.from(document.querySelectorAll(".playing-section .right-section ul li")).findIndex((e=>e.textContent.includes(n.songKeyWord)))},m.onclick=function(){o=Array.from(document.querySelectorAll(".playing-section .right-section ul li")).findIndex((e=>e.textContent.includes(n.songKeyWord))),$("backward",r)},g.onclick=function(){o=Array.from(document.querySelectorAll(".playing-section .right-section ul li")).findIndex((e=>e.textContent.includes(n.songKeyWord))),$("forward",r)};let I=c.some((e=>e.songName===n.songName));function L(e){const n=Math.floor(e/60),t=Math.floor(e%60);return`${n<10?`0${n}`:n} : ${t<10?`0${t}`:t}`}y.classList.toggle("liked",I),y.onclick=function(){if(I=!I,I){c.some((e=>e.songName===n.songName))||(c.push(n),localStorage.setItem("LikedSongs",JSON.stringify(c)))}else{const e=c.filter((e=>e.songName!==n.songName));localStorage.setItem("LikedSongs",JSON.stringify(e))}y.classList.toggle("liked",I)},N.onclick=()=>{e=!e,w(n,e)},x.onclick=function(e){const n=this.clientWidth,o=e.offsetX;t.currentTime=o/n*t.duration}}function w(n,t){const o=document.querySelector(".playing-section .overlay-song-info"),r=o.querySelectorAll(".actions-songs button")[1],l=o.querySelectorAll(".actions-songs button")[0],i=o.querySelectorAll(".actions-songs button")[2];o.querySelector("ul").innerHTML="",o.querySelector("h2").textContent="",o.querySelector("h2").textContent=`(${n.songKeyWord}) - `+n.songName,o.style.display=t?"flex":"none";if(function(e){for(let n of u){if(n.songs.find((n=>n.songName===e)))return console.log(`Song "${e}" found in playlist "${n.name}"`),!0}return!1}(n.songName)){u.filter((e=>e.songs.some((e=>e.songName===n.songName)))).map((e=>e.name)).forEach((e=>{h(o.querySelector("ul"),`Playlist Name: ${e}`,(()=>{sh("hey")}),e,n)}))}else{const e=document.createElement("li");e.textContent=`This song ${n.songName} is not in any of the playlists`,o.querySelector("ul").appendChild(e)}l.onclick=function(){w(n,!1),function(e){const n=document.querySelector(".playlist-hub"),t=n.querySelector(".song-anthem"),o=n.querySelector(".play-inputs input"),r=n.querySelector(".play-inputs button"),l=n.querySelector(".previous-playlist"),i=n.querySelector(".new-playlist"),s=n.querySelector(".playlist-controls button");t.textContent=e.SongName,l.innerHTML="",i.innerHTML="",i.style.display=0===i.children.length?"none":"block",i.previousElementSibling.style.display=0===i.children.length?"none":"block";const a=function(e){return u.filter((n=>n.songs.some((n=>n.songName===e.songName)))).map((e=>e.name))}(e);function c(e,n,t,o,r,l){const i=document.createElement("li");i.innerHTML=`\n                <div class="${n}">\n                    <span>${t}</span>\n                </div>\n                <div class="${o}">\n                    <input type="checkbox" title="Add here">\n                </div>\n            `,e.appendChild(i);const s=i.querySelector("input");s.checked=l,s.addEventListener("change",(function(){const e=u.find((e=>e.name===t));if(e){if(s.checked){e.songs.some((e=>e.songName===r.songName))||(e.songs.push(r),T(`Added "${r.songName}" to ${e.name}`))}else e.songs=e.songs.filter((e=>e.songName!==r.songName)),T(`Removed "${r.songName}" from ${e.name}`),0===e.songs.length&&(u=u.filter((n=>n.name!==e.name)),T(`Playlist "${e.name}" deleted because it's empty`),i.remove());localStorage.setItem("UserPlaylist",JSON.stringify(u))}}))}u.forEach((n=>{n.songs.length>0&&c(l,"song-title",n.name,"song-checkbox",e,a.includes(n.name))})),n.style.display="flex",s.onclick=function(){n.style.display="none"},o.oninput=function(){r.disabled=""===o.value.trim()},r.onclick=function(){const n=o.value.trim();if(!n)return;if(u.find((e=>e.name===n)))return void T("There is a  playlist with the name already!");const t={name:n,songs:[e]};u.push(t),localStorage.setItem("UserPlaylist",JSON.stringify(u)),c(i,"new-song-title",t.name,"new-song-checkbox",e,!0),i.style.display=0===i.children.length?"none":"block",i.previousElementSibling.style.display=0===i.children.length?"none":"block",o.value="",r.disabled=!0}}(n),e=!1},r.onclick=function(){w(n,!1),e=!1,function(n){const t=document.querySelector(".confirmation-overlay"),o=t.querySelector("h2"),r=t.querySelector("p"),l=t.querySelector("input"),i=t.querySelectorAll(".confirmation-buttons button")[0],s=t.querySelectorAll(".confirmation-buttons button")[1],a="VIVALDIpermaz${100}%";o.textContent=`Confirm in Song Name : ${n.songName} Downloading`,r.textContent="PLEASE enter password to continue downloading the song ",t.style.display="flex",s.onclick=function(){t.style.display="none"},l.oninput=function(){i.disabled=l.value.trim()!==a},i.onclick=function(){if(l.value.trim()===a){i.disabled=!0,l.value="";const t=document.createElement("a");t.href=`../${n.songUrl}`,t.download=`Vivaldi_Cantabile_${n.songName}`,t.click(),w(n,!1),e=!1}else alert("Incorrect password!");t.style.display="none"}}(n)},i.onclick=function(){w(n,!1),e=!1,function(e){const n=encodeURIComponent(e.songName),t=`${window.location.origin}/songs/index.html?song=${n}`;navigator.clipboard.writeText(t).then((()=>{T(`Song URL copied to clipboard: ${t}`)})).catch((e=>{console.error("Failed to copy text: ",e),alert("Failed to copy URL. Please try again.")})),console.log(`To play the song, use this URL: ${t}`)}(n)},setTimeout((()=>{o.querySelectorAll("ul li").forEach((e=>{e.onclick=()=>{!function(e){const n=document.querySelector(".overlay-direction"),t=n.querySelector(".confirmation-actions button:first-child"),o=n.querySelector(".confirmation-actions button:last-child");if(n.querySelector("h2 span").textContent=e,!Array.isArray(u))return void console.log("Error: userplayList is not defined or not an array.");const r=u.find((n=>n.name.trim().toLowerCase()===e.trim().toLowerCase()));if(!r)return void console.warn(`Playlist "${e}" not found.`);if(!((r.songs||[]).length>3))return;n.style.display="flex";o.onclick=()=>{n.style.display="none"},t.onclick=function(){const n=encodeURIComponent(e);window.location.href=`../?playlist=${n}`}}(e.textContent.replace("Playlist Name:","").trim())}}))}),100)}function x(e,n,t){const r=q(e.songMood),l=document.querySelector(".left-detail .list-of-moods"),i=document.querySelector(".left-detail .list-of-moods ul"),a=f.find((e=>e.albumName===n))||p.find((e=>e.mood===n));let c=!1;a&&p.includes(a)&&(c=!0);const d=document.createDocumentFragment();i.innerHTML="",r.forEach((n=>{const t=document.createElement("li");t.textContent=n,d.appendChild(t),i.appendChild(d),t.onclick=function(){document.querySelector(".left-detail .list-of-moods ul").innerHTML="",o=Array.from(document.querySelectorAll(".playing-section .right-section ul li")).findIndex((n=>n.textContent.includes(e.songKeyWord))),m=n,localStorage.setItem("currentMood",n);const t=s.filter((e=>e.songMood.includes(m)));k(t[0],m),v(t[0],!0)}}));const u=Array.from(i.querySelectorAll("li")).find((e=>e.textContent===n));u&&(i.querySelectorAll("li").forEach((e=>e.classList.remove("active"))),u.classList.add("active"));const g=f.find((n=>n.albumName===e.songGenre));l.style.backgroundImage=`url(${g.albumImage})`,t?k(e,n):C(e,c,n),function(e){const n=document.querySelector(".detail-section .right-detail ul"),t=e.songGenre,r=f.filter((e=>e.albumName!==t));if(n.innerHTML="",r.length>0)r.forEach((t=>{const r=document.createElement("li");r.textContent=t.albumName,n.appendChild(r),r.onclick=function(){document.querySelector(".left-detail .list-of-moods ul").innerHTML="",o=Array.from(document.querySelectorAll(".playing-section .right-section ul li")).findIndex((n=>n.textContent.includes(e.songKeyWord)));const n=s.filter((e=>e.songGenre===t.albumName));n.length>0?(C(n[0],!1,t.albumName),v(n[0],!1)):alert(`No songs available in the album "${t.albumName}".`)}}));else{const e=document.createElement("li");e.textContent="No other albums available.",n.appendChild(e)}}(e),o=Array.from(document.querySelectorAll(".playing-section .right-section ul li")).findIndex((n=>n.textContent.includes(e.songKeyWord)))}function C(e,n,t){const l=document.querySelector(".playing-section .right-section ul"),i=document.querySelector(".playing-section .right-section h2");l.innerHTML="";const a=s.filter((e=>n?e.songMood.some((e=>e===t)):e.songGenre===t));if(0===a.length)return void alert("no songs to recommend to your playlist");r=[...a];const c=a.findIndex((n=>n.songName===e.songName));if(c>-1){const[e]=a.splice(c,1);a.unshift(e)}i.textContent=`${t} (${c+1} / ${r.length})`,r.forEach(((e,n)=>{const t=document.createElement("li");t.textContent=`${n+1}.${e.songKeyWord}`,l.appendChild(t),t.onclick=function(){const n=Array.from(l.querySelectorAll("li")).findIndex((n=>n.textContent.includes(e.songKeyWord)));n>-1&&(console.log(n),o=n),v(e,!1)}})),l.querySelectorAll("li").forEach((e=>{e.classList.remove("playing")}));const d=Array.from(l.querySelectorAll("li")).find((n=>n.textContent.includes(e.songKeyWord)));d&&d.classList.add("playing"),o=Array.from(document.querySelectorAll(".playing-section .right-section ul li")).findIndex((n=>n.textContent.includes(e.songKeyWord)))}function k(e,n){const t=document.querySelector(".playing-section .right-section ul"),l=document.querySelector(".playing-section .right-section h2");t.innerHTML="",console.log("category in mood",n);const i=s.filter((e=>e.songMood.includes(n)));if(0===i.length)return void alert("Non songno musika del mood");r=[...i],console.log(r);const a=i.findIndex((n=>n.songName===e.songName));l.textContent=`${n} (${a+1} / ${r.length})`,r.forEach(((e,n)=>{const r=document.createElement("li");r.textContent=`${n+1}.${e.songKeyWord}`,t.appendChild(r),r.onclick=function(){const n=Array.from(t.querySelectorAll("li")).findIndex((n=>n.textContent.includes(e.songKeyWord)));n>-1&&(console.log(n),o=n),v(e,!0)}})),t.querySelectorAll("li").forEach((e=>{e.classList.remove("playing")}));const c=Array.from(t.querySelectorAll("li")).find((n=>n.textContent.includes(e.songKeyWord)));c&&c.classList.add("playing"),o=Array.from(document.querySelectorAll(".playing-section .right-section ul li")).findIndex((n=>n.textContent.includes(e.songKeyWord)))}function $(e,n){const t=document.querySelectorAll(".playing-section .right-section ul li"),r=Array.from(t).map((e=>e.textContent.split(".").slice(1).join(".").trim()));console.log("Playlist Keywords:",r);const l=s.filter((e=>r.includes(e.songKeyWord)));if(0===l.length)return void console.error("Playlist array is empty! Check if the keywords match songKeyWord.");console.log("Filtered Playlist Array:",l),o="forward"===e?(o+1)%l.length:(o-1+l.length)%l.length;const i=l[o];t.forEach((e=>e.classList.remove("playing"))),t[o]&&t[o].classList.add("playing"),console.log(`Playing next song: ${i.songName}`),v(i,n)}function I(e){h(document.querySelector(".liked-songs ul"),e.songKeyWord,E,e)}if(p.forEach((e=>console.log(e.mood))),fetch("../songs.json").then((e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()})).then((e=>{a.push(...e),fetch("../songs.json").then((e=>e.json())).then((e=>{e.forEach((e=>{const n=[];n.push(e.songArtist1),e.songArtist2&&n.push(e.songArtist2);const t={"@context":"http://schema.org","@type":"Song",name:e.songName,genre:e.songGenre,byArtist:n.map((e=>({"@type":"MusicAlbum",name:e}))),keywords:e.songKeyWord,mood:e.songMood},o=document.createElement("script");o.type="application/ld+json",o.textContent=JSON.stringify(t),document.head.appendChild(o),function(e){const n=document.querySelector("title");n&&(n.textContent=`${e.songName} - ${e.songArtist1||e.songArtist2}`);let t=document.querySelector('meta[name="description"]');t||(t=document.createElement("meta"),t.setAttribute("name","description"),document.head.appendChild(t)),t.setAttribute("content",`${e.songName} by ${e.songArtist1||e.songArtist2}. Genre: ${e.songGenre}.`);let o=document.querySelector('meta[name="keywords"]');o||(o=document.createElement("meta"),o.setAttribute("name","keywords"),document.head.appendChild(o)),o.setAttribute("content",`${e.songName}, ${e.songGenre}, ${e.songArtist1||e.songArtist2}`)}(e)}))})).catch((e=>console.error("Error fetching song data:",e))),function(){const e=JSON.parse(localStorage.getItem("currentSong")),t=localStorage.getItem("songSource"),o=localStorage.getItem("currentMood");let r,l=4;if(e){n="mood"===t,S(e);const i=document.querySelector(".overlay-confirmation");i&&(i.querySelector("h3").textContent=e.songName+`- ${e.songGenre}`,i.querySelector("h4").textContent=l,i.style.display="flex",setTimeout((()=>{r=setInterval((function(){if(l--,i.querySelector("h4").textContent=`${l}`,0===l){clearInterval(r),i.style.display="none",N(e,n);const l="mood"===t?o:e.songGenre;n&&(m=o),x(e,l,n)}l<=1&&(i.querySelectorAll(".confirmation-actions button")[1].style.display="none")}),1e3)}),2e3),i.querySelectorAll(".confirmation-actions button")[0].onclick=function(){i.style.display="none",N(e,n);const l="mood"===t?o:e.songGenre;n&&(m=o),x(e,l,n),clearInterval(r)},i.querySelectorAll(".confirmation-actions button")[1].onclick=function(){A(0),i.style.display="none",clearInterval(r)})}else T("No songs available"),function(){const e=new URLSearchParams(window.location.search).get("song");let n,t=4;if(e){const o=function(e){if(Array.isArray(s)){const n=s.find((n=>n.songName===e));if(n)return n;console.warn(`Song with title "${e}" not found in the array.`)}else console.error("allSongArray is not defined or not an array.");return null}(e);S(o);const r=document.querySelector(".overlay-confirmation");r&&(r.querySelector("h3").textContent=`${o.songName} - ${o.songGenre}`,r.querySelector("h4").textContent=t,r.style.display="flex",setTimeout((()=>{n=setInterval((()=>{t--,r.querySelector("h4").textContent=`${t}`,0===t&&(clearInterval(n),r.style.display="none",N(o,!1),x(o,o.songGenre,!1)),t<=1&&(r.querySelectorAll(".confirmation-actions button")[1].style.display="none")}),1e3)}),2e3),r.querySelectorAll(".confirmation-actions button")[0].onclick=function(){r.style.display="none",N(o,!1),x(o,o.songGenre,!1),clearInterval(n)},r.querySelectorAll(".confirmation-actions button")[1].onclick=function(){A(0),r.style.display="none",clearInterval(n)})}else window.location.href="../index.html"}()}(),s=q(a),T(`Songs total: ${s.length}`);const t=s.filter((e=>!c.some((n=>n.songName===e.songName))&&!d.some((n=>n.songName===e.songName))));t.length>0?q(t).forEach((e=>{b(e)})):q(s).forEach(b),g.disabled=!1,l=Array.isArray(s)&&s.length>0?s.map((e=>e.songName)):[],i=Array.isArray(s)&&s.length>0?s.map((e=>[e.songArtist1??"Unknown Artist",e.songArtist2??"Unknown Artist"])).flat().filter((e=>"Unknown Artist"!==e)):[]})).catch((e=>{console.error("Error fetching songs:",e)})),"#spotlight"===window.location.hash?A(1):A(0),c.length>0)c.forEach((e=>{I(e)}));else{const e=document.querySelector(".liked-songs");e&&(e.style.display="none")}function L(e){h(document.querySelector(".listened-songs ul"),e.songKeyWord,E,e)}if(d.length>0)d.forEach((e=>{L(e)}));else{const e=document.querySelector(".listened-songs");e&&(e.style.display="none")}function E(e){console.log(e),localStorage.setItem("currentSong",JSON.stringify(e)),N(e,!1),x(e,e.songGenre,!1)}if(p.length>0){!function(e){const n=document.querySelector("main #Feed .mood-display ul");console.log(n),n?e.forEach((e=>{h(n,e.mood,M,e.mood)})):console.error("The container was not found!")}(q(p))}function M(e){console.log(e);const n=s.filter((n=>n.songMood.some((n=>n===e))));if(0===n.length)return void alert("There is no song");const t=n[Math.floor(Math.random()*n.length)];localStorage.setItem("currentSong",JSON.stringify(t)),localStorage.setItem("currentMood",e),m=e,N(t,!0),x(t,e,!0)}function T(e,n="../logo.jpg"){const t=document.querySelector(".notification-section"),o=t.querySelector(".img img"),r=t.querySelector(".message-section span");if(o.src="",r.textContent="",r.textContent=e,o.src=n,"granted"===Notification.permission)if("visible"!==document.visibilityState){new Notification("Vivaldi Cantabile",{body:e,icon:"../logo.jpg",image:n}).onclick=()=>window.focus()}else t.style.display="flex",setTimeout((()=>{t.style.display="none"}),5e3);else Notification.requestPermission().then((o=>{"granted"===o?T(e,n):(t.style.display="flex",setTimeout((()=>{t.style.display="none"}),5e3))}));t.onclick=function(){t.style.display="none"}}function H(e=[]){let n=[];const t=document.querySelector("#SearchField .result-field ul");t.innerHTML="",n=0===e.length?[...s]:[...e];n.slice(0,20).forEach((e=>{const n=document.createElement("li"),o=f.find((n=>n.albumName===e.songGenre));n.innerHTML=`\n                <div class="image-content-output">\n                    <img src="${o?o.albumImage:"./logo.jpg"}" alt="result image">\n                </div>\n                <div class="song-name-content">\n                    <h3>${e.songName}</h3>\n                    <p>${e.songArtist1} ${e.songArtist2?`Featuring ${e.songArtist2}`:""}</p>\n                </div>\n            `,n.onclick=function(){E(e)},t.appendChild(n)}))}g.onclick=function(){if(t&&!t.paused&&t.pause(),d.length>0)d.forEach((e=>{document.querySelector(".listened-songs ul").innerHTML="",L(e)}));else{const e=document.querySelector(".listened-songs");e&&(e.style.display="none")}if(c.length>0)document.querySelector(".liked-songs ul").innerHTML="",c.forEach((e=>{I(e)}));else{const e=document.querySelector(".liked-songs");e&&(e.style.display="none")}A(0)},y.onclick=function(){A(2);H(q(d))},document.querySelector("#SearchField .header-search input").oninput=function(){const e=this.value.trim().toLowerCase();if(e&&(l.some((n=>n.toLowerCase().includes(e)))||i.some((n=>n.toLowerCase().includes(e))))){const n=s.find((n=>n.songName.toLowerCase().includes(e)))||s.find((n=>n.songArtist1.toLowerCase().includes(e)||n.songArtist2&&n.songArtist2.toLowerCase().includes(e)));if(n){const e=n.songGenre,t=s.filter((n=>n.songGenre===e));H([n,...t.filter((e=>e.songName!==n.songName))])}}},document.querySelectorAll(".header-search button")[1].onclick=function(){A(t?1:0)}}));
